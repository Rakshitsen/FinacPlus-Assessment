// pipeline {
//   agent any

//   stages {
//     stage('Build') {
//       steps {
//         sh 'docker --version'
//       }
//     }

//     stage('Test') {
//       steps {
//         sh 'kubectl version --client'
//       }
//     }

//     stage('Deploy') {
//       steps {
//         withCredentials([file(credentialsId: 'KUBECONFIG_FILE', variable: 'KUBECONFIG')]) {
//           // kubectl will read the file path from $KUBECONFIG
//           sh '''
//             kubectl config current-context
//             kubectl get nodes
//           '''
//         }
//       }
//     }
//   }
// }



node{
    stage('Build') {
        sh 'docker --version'
    }

    stage('Test') {
        sh 'kubectl version --client'
    }

    stage('Deploy') {
        withCredentials([file(credentialsId: 'KUBECONFIG_FILE', variable: 'KUBECONFIG')]) {
            // kubectl will read the file path from $KUBECONFIG
            sh '''
                kubectl config current-context
                kubectl get nodes
            '''
        }
    }
}